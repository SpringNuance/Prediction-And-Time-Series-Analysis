par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(MLCO2ts,main="ACF")
pacf(MLCO2ts,main="PACF")
acf(Intel_Close,main="ACF") #decays exponentially?
pacf(Intel_Close,main="PACF") #cuts off after lag 2?
acf(MLCO2ts,main="ACF")
library(forecast) # Run every time you want to use functions of the forecast package
MLCO2 <- read.table("MLCO2.txt",header=T)
MLCO2ts <- ts(MLCO2)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(MLCO2ts,main="ACF")
pacf(MLCO2ts,main="PACF")
library(forecast) # Run every time you want to use functions of the forecast package
MLCO2 <- read.table("MLCO2.txt",header=T)
MLCO2ts <- ts(MLCO2$MLCO2, start = 1)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(MLCO2ts,main="ACF")
pacf(MLCO2ts,main="PACF")
library(forecast) # Run every time you want to use functions of the forecast package
MLCO2 <- read.table("MLCO2.txt",header=T)
MLCO2ts <- ts(MLCO2$MLCO2, frequency = 1, start = 1)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(MLCO2ts,main="ACF")
pacf(MLCO2ts,main="PACF")
library(forecast) # Run every time you want to use functions of the forecast package
MLCO2 <- read.table("MLCO2.txt",header=T)
MLCO2ts <- ts(MLCO2$MLCO2, frequency = 1, start = 1)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(MLCO2ts,main="ACF")
pacf(MLCO2ts,main="PACF")
library(forecast) # Run every time you want to use functions of the forecast package
MLCO2 <- read.table("MLCO2.txt",header=T)
mlco2ts <- ts(MLCO2$MLCO2, frequency = 1)
plot(mlco2ts, xlab = "Year" ,ylab = "CO2", main = "Graph")
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2ts,main="ACF")
pacf(mlco2ts,main="PACF")
library(forecast) # Run every time you want to use functions of the forecast package
MLCO2 <- read.table("MLCO2.txt",header=T)
mlco2ts <- ts(MLCO2$MLCO2, frequency = 1)
plot(mlco2ts, xlab = "Year" ,ylab = "CO2", main = "Graph")
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2ts,main="ACF")
pacf(mlco2ts,main="PACF")
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2ts,main="ACF", lag=1)
pacf(mlco2ts,main="PACF", lag=1)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2ts,main="ACF", lag.max=50)
pacf(mlco2ts,main="PACF", lag.max=50)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2ts,main="ACF", lag.max=220)
pacf(mlco2ts,main="PACF", lag.max=220)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2ts,main="ACF", lag.max=50)
pacf(mlco2ts,main="PACF", lag.max=50)
library(forecast) # Run every time you want to use functions of the forecast package
MLCO2 <- read.table("MLCO2.txt",header=T)
mlco2ts <- ts(MLCO2$MLCO2, frequency = 1)
plot(mlco2ts, xlab = "Month" ,ylab = "CO2 measurement", main = "Time series of CO2 measurements from the Mauna Loa volcano")
library(forecast) # Run every time you want to use functions of the forecast package
MLCO2 <- read.table("MLCO2.txt",header=T)
mlco2ts <- ts(MLCO2$MLCO2, frequency = 1)
plot(mlco2ts, xlab = "Month" ,ylab = "CO2 measurements", main = "Time series of CO2 measurements from the Mauna Loa volcano")
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2ts,main="ACF", lag.max=50)
pacf(mlco2ts,main="PACF", lag.max=50)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2ts,main="ACF", lag.max=100)
pacf(mlco2ts,main="PACF", lag.max=100)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2ts,main="ACF", lag.max=100)
pacf(mlco2ts,main="PACF", lag.max=100)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2ts,main="ACF", lag.max=200)
pacf(mlco2ts,main="PACF", lag.max=200)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2ts,main="ACF", lag.max=50)
pacf(mlco2ts,main="PACF", lag.max=50)
mlco2_AR2 <- Arima(mlco2ts,order=c(2,0,0))
acf(mlco2_AR2$res)
pacf(mlco2_AR2$res)
mlco2_AR2 <- Arima(mlco2ts,order=c(2,0,0))
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2_AR2$res)
pacf(mlco2_AR2$res)
mlco2_AR2 <- Arima(mlco2ts,order=c(2,0,0))
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2_AR2$res, main="AR(2)−model − ACF of residuals")
pacf(mlco2_AR2$res, main="AR(2)−model − PACF of residuals")
mlco2_AR2 <- Arima(mlco2ts,order=c(2,0,0))
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2_AR2$res, main="AR(2)−model − ACF of residuals", lag.max = 50)
pacf(mlco2_AR2$res, main="AR(2)−model − PACF of residuals", lag.max = 50)
?Box.text
?Box
k <- 2
mlco2_bl <- rep(NA,47)
for (i in 1:47) {
mlco2_bl[i] = Box.test(mlco2_AR2$res,lag = (i+k) , fitdf = k, type="Ljung-Box")$p.value
}
round(mlco2_bl,3)
k <- 2
mlco2_bl <- rep(NA,47)
for (i in 1:47) {
mlco2_bl[i] = Box.test(mlco2_AR2$res,lag = (i+k) , fitdf = k, type="Ljung-Box")$p.value
}
round(mlco2_bl)
k <- 2
mlco2_bl <- rep(NA,47)
for (i in 1:47) {
mlco2_bl[i] = Box.test(mlco2_AR2$res,lag = (i+k) , fitdf = k, type="Ljung-Box")$p.value
}
mlco2_bl
mlco2_AR2 <- Arima(mlco2ts,order=c(2,0,0))
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2_AR2$res, main="AR(2)−model − ACF of residuals", lag.max = 50)
pacf(mlco2_AR2$res, main="AR(2)−model − PACF of residuals", lag.max = 50)
mlco2ts.auto <- auto.arima(mlco2ts)
mlco2ts.auto
mlco2tsSARIMA <- auto.arima(mlco2ts)
mlco2tsSARIMA <- auto.arima(mlco2ts)
mlco2tsSARIMA
model_sales <- auto.arima(Sales)
model_sales
library(forecast) # Run every time you want to use functions of the forecast package
MLCO2 <- read.table("MLCO2.txt",header=T)
mlco2ts <- ts(MLCO2$MLCO2, frequency = 12)
plot(mlco2ts, xlab = "Month" ,ylab = "CO2 measurements", main = "Time series of CO2 measurements from the Mauna Loa volcano")
mlco2ts <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2 <- auto.arima(mlco2ts)
mlco2ts <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2 <- auto.arima(mlco2ts)
mlco2ts <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2 <- auto.arima(mlco2ts)
mlco2ts <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2 <- auto.arima(mlco2ts)
library(forecast) # Run every time you want to use functions of the forecast package
MLCO2 <- read.table("MLCO2.txt",header=T)
mlco2ts <- ts(MLCO2$MLCO2, frequency = 1)
plot(mlco2ts, xlab = "Month" ,ylab = "CO2 measurements", main = "Time series of CO2 measurements from the Mauna Loa volcano")
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2ts,main="ACF", lag.max=50)
pacf(mlco2ts,main="PACF", lag.max=50)
mlco2SeasonTs <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2 <- auto.arima(mlco2SeasonTs)
model_mlco2
mlco2SeasonTs <- ts(MLCO2$MLCO2, period = 12)
mlco2SeasonTs <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2 <- auto.arima(mlco2SeasonTs)
model_mlco2
mlco2SeasonTs <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2 <- auto.arima(mlco2ts)
model_mlco2
mlco2SeasonTs <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2 <- auto.arima(mlco2ts)
model_mlco2d <- auto.arima(model_mlco2, frequency = 12)
mlco2SeasonTs <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2 <- auto.arima(mlco2ts)
mlco2SeasonTs <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2 <- auto.arima(mlco2ts)
mlco2SeasonTs <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2 <- auto.arima(mlco2SeasonTs)
mlco2SeasonTs <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2 <- auto.arima(mlco2SeasonTs)
model_mlco2
mlco2SeasonTs <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2 <- auto.arima(mlco2ts)
model_mlco2
mlco2SeasonTs <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2 <- auto.arima(mlco2ts)
model_mlco2
mlco2Diff <- diff(mlco2ts, lag = 12)
acf(mlco2Diff)
pacf(mlco2Diff)
mlco2Diff <- diff(mlco2ts, lag = 12)
acf(mlco2Diff, lag.max = 50)
pacf(mlco2Diff, lag.max = 50)
mlco2Diff <- diff(mlco2ts, lag = 2)
acf(mlco2Diff, lag.max = 50)
pacf(mlco2Diff, lag.max = 50)
mlco2Diff <- diff(mlco2ts, lag = 24)
acf(mlco2Diff, lag.max = 50)
pacf(mlco2Diff, lag.max = 50)
mlco2SeasonTs <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2Season <- auto.arima(mlco2SeasonTs)
model_mlco2Season
mlco2SeasonTs <- ts(MLCO2$MLCO2, frequency = 12)
model_mlco2Season <- auto.arima(mlco2SeasonTs)
model_mlco2Season
model_sales2 <- Arima(Sales,order=c(2,1,1),season=c(0,1,2), period = 12)
model_sales2 <- Arima(Sales,order=c(2,1,1), seasonal=list(order=c(0,1,2),periodc=12))
modelSARIMA <- Arima(mlco2ts,order=c(2,1,1), seasonal=list(order=c(0,1,2),periodc=12))
acf(modelSARIMA$res,main="ACF of residuals",lag.max=50)
pacf(modelSARIMA$res, main="PACF of residuals", lag.max=50)
modelSARIMA <- Arima(mlco2ts,order=c(2,1,1), seasonal=list(order=c(0,1,2),periodc=12))
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(modelSARIMA$res,main="ACF of residuals",lag.max=50)
pacf(modelSARIMA$res, main="PACF of residuals", lag.max=50)
modelSARIMA <- Arima(mlco2ts,order=c(0,1,2), seasonal=list(order=c(2,1,0),periodc=12))
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(modelSARIMA$res,main="ACF of residuals",lag.max=50)
pacf(modelSARIMA$res, main="PACF of residuals", lag.max=50)
modelSARIMA <- Arima(mlco2ts,order=c(2,1,1), seasonal=list(order=c(0,1,2),periodc=12))
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(modelSARIMA$res,main="ACF of residuals",lag.max=200)
pacf(modelSARIMA$res, main="PACF of residuals", lag.max=200)
k <- 3
mlco2_bl <- rep(NA,47)
for (i in 1:47) {
mlco2_bl[i]=Box.test(modelSARIMA$res,lag=(i+k),fitdf=k, type="Ljung-Box")$p.value
}
round(sales_lb2,3)
modelSARIMA <- Arima(mlco2ts,order=c(2,1,1), seasonal=list(order=c(0,1,2),periodc=12))
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(modelSARIMA$res,main="ACF of residuals",lag.max=50)
pacf(modelSARIMA$res, main="PACF of residuals", lag.max=50)
k <- 3
mlco2_bl <- rep(NA,47)
for (i in 1:47) {
mlco2_bl[i]=Box.test(modelSARIMA$res,lag=(i+k),fitdf=k, type="Ljung-Box")$p.value
}
round(sales_lb2,3)
k <- 5
mlco2_bl <- rep(NA,45)
for (i in 1:45) {
mlco2_bl[i]=Box.test(modelSARIMA$res,lag=(i+k),fitdf=k, type="Ljung-Box")$p.value
}
mlco2_bl
k <- 2
mlco2_bl <- rep(NA,47)
for (i in 1:47) {
mlco2_bl[i]=Box.test(modelSARIMA$res,lag=(i+k),fitdf=k, type="Ljung-Box")$p.value
}
mlco2_bl
k <- 2
mlco2_bl <- rep(NA,47)
for (i in 1:47) {
mlco2_bl[i]=Box.test(modelSARIMA$res,lag=(i+k),fitdf=k, type="Ljung-Box")$p.value
}
round(mlco2_bl, 3)
k <- 2
mlco2_bl <- rep(NA,47)
for (i in 1:47) {
mlco2_bl[i]=Box.test(modelSARIMA$res,lag=(i+k),fitdf=k, type="Ljung-Box")$p.value
}
round(mlco2_bl, 3)
which(mlco2_bl > 0.05)
k <- 2
mlco2_bl <- rep(NA,47)
for (i in 1:47) {
mlco2_bl[i]=Box.test(modelSARIMA$res,lag=(i+k),fitdf=k, type="Ljung-Box")$p.value
}
round(mlco2_bl, 3)
which(mlco2_bl < 0.05)
model_sales
k <- 5
mlco2_bl <- rep(NA,47)
for (i in 1:47) {
mlco2_bl[i]=Box.test(modelSARIMA$res,lag=(i+k),fitdf=k, type="Ljung-Box")$p.value
}
round(mlco2_bl, 3)
which(mlco2_bl < 0.05)
# Set the starting year correctly
predictiona <- ts(forecast(model_vera,h=43,level=FALSE)$mean,start=1921)
predictiona1 <- ts(forecast(model_vera1,h=5,level=FALSE)$mean,start=1959)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
plot(Spots,col="red",type="l",ylim=c(0,200),
ylab="Lkm.",xlab="Time",main="43 step prediction")
lines(predictiona,col="blue",type="l")
plot(Spots,col="red",type="l",ylim=c(0,200),
ylab="Lkm.",xlab="Time",main="5 step prediction")
lines(predictiona1,col="blue",type="l")
fit.sales <- fitted(model_sales2)
plot(fit.sales,type="b",col="blue", ylab="Sales",xlab="Time")
lines(Sales,col="red",type="b")
prediction_sales <- forecast(model_sales2,h=48,level=FALSE)$mean
plot(Sales,col="red",type="b",ylim=c(100,340),
xlim=c(1970,1987),ylab="Sales",xlab="Time")
lines(prediction_sales,col="blue",type="b")
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month")
lines(mlco2ts,col="red",type="b")
prediction_sales <- forecast(model_sales2,h=48,level=FALSE)$mean
plot(Sales,col="red",type="b",ylim=c(100,340),
xlim=c(1970,1987),ylab="Sales",xlab="Time")
lines(prediction_sales,col="blue",type="b")
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month")
lines(mlco2ts,col="red",type="b")
legend(16,68, legend=c("Original time series", "SARIMA fit"),
col=c("red","blue"),lty=c(1,1),cex=0.8)
prediction_sales <- forecast(model_sales2,h=48,level=FALSE)$mean
plot(Sales,col="red",type="b",ylim=c(100,340),
xlim=c(1970,1987),ylab="Sales",xlab="Time")
lines(prediction_sales,col="blue",type="b")
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month")
lines(mlco2ts,col="red",type="b")
legend(16,68, legend=c("Original time series", "SARIMA fit"),
col=c("red","blue"),lty=c(1,1),cex=0.8)
prediction_sales <- forecast(model_sales2,h=48,level=FALSE)$mean
plot(Sales,col="red",type="b",ylim=c(100,340),
xlim=c(1970,1987),ylab="Sales",xlab="Time")
lines(prediction_sales,col="blue",type="b")
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month")
lines(mlco2ts,col="red",type="b")
legend(16,68, legend=c("Original time series", "SARIMA fit"),
col=c("red","blue"),lty=c(1,1),cex=0.8)
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month")
lines(mlco2ts,col="red",type="b")
legend(2,32, legend=c("Original time series", "SARIMA fit"),
col=c("red","blue"),lty=c(1,1),cex=0.8)
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month")
lines(mlco2ts,col="red",type="b")
legend(2,16, legend=c("Original time series", "SARIMA fit"),
col=c("red","blue"),lty=c(1,1),cex=0.8)
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month")
lines(mlco2ts,col="red",type="b")
legend(10,16, legend=c("Original time series", "SARIMA fit"),
col=c("red","blue"),lty=c(1,1),cex=0.8)
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month")
lines(mlco2ts,col="red",type="b")
legend(100,16, legend=c("Original time series", "SARIMA fit"),
col=c("red","blue"),lty=c(1,1),cex=0.8)
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month")
lines(mlco2ts,col="red",type="b")
legend(150,16, legend=c("Original time series", "SARIMA fit"),
col=c("red","blue"),lty=c(1,1),cex=0.8)
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month")
lines(mlco2ts,col="red",type="b")
legend(150,20, legend=c("Original time series", "SARIMA fit"),
col=c("red","blue"),lty=c(1,1),cex=0.8)
prediction2steps <- ts(forecast(modelSARIMA,h=2,level=FALSE)$mean,start=217)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
plot(mlco2ts,col="red",type="l",ylim=c(0,200),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 2 step prediction")
lines(prediction2steps,col="blue",type="l")
prediction2steps <- ts(forecast(modelSARIMA,h=2,level=FALSE)$mean,start=217)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
plot(mlco2ts,col="red",type="l",ylim=c(0,40),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 2 step prediction")
lines(prediction2steps,col="blue",type="l")
currentSARIMA = arima(mlco2[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),periodc=12) )
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),periodc=12) )
prediction2steps <-ts(forecast(currentSARIMA,h=2,level=FALSE)$mean,start=217)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
plot(mlco2ts,col="red",type="l",ylim=c(0,40),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 2 step prediction")
lines(prediction2steps,col="blue",type="l")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-ts(forecast(currentSARIMA,h=2,level=FALSE)$mean,start=217)
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
plot(mlco2ts,col="red",type="l",ylim=c(0,40),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 2 step prediction")
lines(prediction2steps,col="blue",type="l")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=2,level=FALSE)$mean
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
plot(mlco2ts,col="red",type="b",
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 2 step prediction")
lines(prediction2steps,col="blue",type="l")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=2,level=FALSE)$mean
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
plot(mlco2ts,col="red",type="b",
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 2 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=2,level=FALSE)$mean
plot(mlco2ts,col="red",type="b",
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 2 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=2,level=FALSE)$mean
plot(mlco2ts,col="red",type="b",
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 2 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=24,level=FALSE)$mean
plot(mlco2ts,col="red",type="b",
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 2 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=24,level=FALSE)$mean
plot(mlco2ts,col="red",type="b", xlim=c(0, 300),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 2 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=24,level=FALSE)$mean
plot(mlco2ts,col="red",type="b", xlim=c(0, 300), ylim =c(10,50),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 2 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=24,level=FALSE)$mean
plot(mlco2ts,col="red",type="b", xlim=c(0, 250), ylim =c(10,50),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 2 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=24,level=FALSE)$mean
plot(mlco2ts,col="red",type="b", xlim=c(0, 250), ylim =c(10,40),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 2 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=24,level=FALSE)$mean
plot(mlco2ts,col="red",type="b", xlim=c(0, 250), ylim =c(10,40),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 24 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=100,level=FALSE)$mean
plot(mlco2ts,col="red",type="b", xlim=c(0, 300), ylim =c(10,60),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 24 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=100,level=FALSE, start = 100)$mean
plot(mlco2ts,col="red",type="b", xlim=c(0, 300), ylim =c(10,60),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 24 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=100,level=FALSE)$mean
plot(mlco2ts,col="red",type="b", xlim=c(0, 300), ylim =c(10,60),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 100 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=100,level=FALSE)$mean
plot(mlco2ts,col="red",type="b", xlim=c(0, 350), ylim =c(10,60),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 100 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=100,level=FALSE)$mean
plot(mlco2ts,col="red",type="b", xlim=c(0, 320), ylim =c(10,60),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 100 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=100,level=FALSE)$mean
plot(mlco2ts,col="red",type="b", xlim=c(0, 320), ylim =c(10,40),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 100 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=100,level=FALSE)$mean
plot(mlco2ts,col="red",type="b", xlim=c(0, 320), ylim =c(10,45),
ylab="CO2 measurements",xlab="Months",main="CO2 measure from Mauna Loa volcano: 100 step prediction")
lines(prediction2steps,col="blue",type="b")
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(mlco2ts,main="ACF", lag.max=50)
pacf(mlco2ts,main="PACF", lag.max=50)
modelSARIMA <- Arima(mlco2ts,order=c(2,1,1), seasonal=list(order=c(0,1,2),periodc=12))
par(mfrow=c(1,2),mar=c(2.5,2.5,3.5,1.5))
acf(modelSARIMA$res,main="ACF of residuals",lag.max=50)
pacf(modelSARIMA$res, main="PACF of residuals", lag.max=50)
k <- 5
mlco2_bl <- rep(NA,47)
for (i in 1:47) {
mlco2_bl[i]=Box.test(modelSARIMA$res,lag=(i+k),fitdf=k, type="Ljung-Box")$p.value
}
round(mlco2_bl, 3)
which(mlco2_bl < 0.05)
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month")
lines(mlco2ts,col="red",type="b")
legend(150,20, legend=c("Original time series", "SARIMA fit"),
col=c("red","blue"),lty=c(1,1),cex=0.8)
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month", main="Time series of CO2 measurements from the Mauna Loa volcano")
lines(mlco2ts,col="red",type="b")
legend(150,20, legend=c("Original time series", "SARIMA fit"),
col=c("red","blue"),lty=c(1,1),cex=0.8)
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month", main="CO2 measurements from the Mauna Loa volcano")
lines(mlco2ts,col="red",type="b")
legend(150,20, legend=c("Original time series", "SARIMA fit"),
col=c("red","blue"),lty=c(1,1),cex=0.8)
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=2,level=FALSE)$mean
plot(mlco2ts,col="red",type="b",
ylab="CO2 measurements",xlab="Months",main="CO2 measure: 2 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=24,level=FALSE)$mean
plot(mlco2ts,col="red",type="b", xlim=c(0, 250), ylim =c(10,40),
ylab="CO2 measurements",xlab="Months",main="CO2 measure: 24 step prediction")
lines(prediction2steps,col="blue",type="b")
currentSARIMA = arima(mlco2ts[1:216],order=c(2,1,1), seasonal=list(order=c(0,1,2),period=12) )
prediction2steps <-forecast(currentSARIMA,h=100,level=FALSE)$mean
plot(mlco2ts,col="red",type="b", xlim=c(0, 320), ylim =c(10,45),
ylab="CO2 measurements",xlab="Months",main="CO2 measure: 100 step prediction")
lines(prediction2steps,col="blue",type="b")
library(forecast) # Run every time you want to use functions of the forecast package
MLCO2 <- read.table("MLCO2.txt",header=T)
mlco2ts <- ts(MLCO2$MLCO2, frequency = 1)
plot(mlco2ts, xlab = "Month" ,ylab = "CO2 measurements", main = "CO2 measurements from the Mauna Loa volcano")
library(forecast) # Run every time you want to use functions of the forecast package
MLCO2 <- read.table("MLCO2.txt",header=T)
mlco2ts <- ts(MLCO2$MLCO2, frequency = 1)
plot(mlco2ts, xlab = "Month" ,ylab = "CO2 measurements", main = "CO2 measurements from Mauna Loa volcano")
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month", main="CO2 measurements from Mauna Loa volcano")
lines(mlco2ts,col="red",type="b")
legend(150,20, legend=c("Original time series", "SARIMA fit"),
col=c("red","blue"),lty=c(1,1),cex=0.8)
fit.mlco2 <- fitted(modelSARIMA)
plot(fit.mlco2,type="b",col="blue", ylab="CO2 measurements",xlab="Month", main="CO2 measurements from Mauna Loa volcano")
lines(mlco2ts,col="red",type="b")
legend(120,16, legend=c("Original time series", "SARIMA fit"),
col=c("red","blue"),lty=c(1,1),cex=0.8)
