source("C:/Users/nguye/Desktop/Prediction and Time Series Analysis/Week 1/Computer exercises 1-20211101/demo_week1.R", echo=TRUE)
# For HW
?plot
?abline
source("C:/Users/nguye/Desktop/Prediction and Time Series Analysis/Week 1/Computer exercises 1-20211101/demo_week1.R", echo=TRUE)
source("C:/Users/nguye/Desktop/Prediction and Time Series Analysis/Week 1/Computer exercises 1-20211101/computer_exercise_week1.R", echo=TRUE)
source("C:/Users/nguye/Desktop/Prediction and Time Series Analysis/Week 1/Computer exercises 1-20211101/computer_exercise_week1.R", echo=TRUE)
emission_data_og <- read.table('emissions.txt', header=T, sep = '\t')
emission_data_og$Obsno
# Let's drop the first column
emission_data <- emission_data_og[,-1]
# Set seed to get deterministic results
set.seed(123)
par(mfrow = c(2,2))
hist(emission_data$NOx)
hist(emission_data$Humidity)
hist(emission_data$Temp)
hist(emission_data$Pressure)
apply(emission_data, 2, hist) # not that pretty
var_names <- colnames(emission_data)
var_names
knitr::opts_chunk$set(echo = TRUE)
plot(pressure)
summary(cars)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
update.packages(ask = FALSE, checkBuilt = TRUE)
tinytex::tlmgr_update()
options(tinytex.verbose = TRUE)
tobacco_data_og <- read.table('tobacco.txt', header=T, sep = '\t')
View(tobacco_data_og)
tobacco_data_og$ILL
# Set seed to get deterministic results
set.seed(123)
#a)
lm_ill <- lm(ILL ~ CONSUMPTION, data = tobacco_data)
tobacco_data<- read.table('tobacco.txt', header=T, sep = '\t')
#a)
lm_ill <- lm(ILL ~ CONSUMPTION, data = tobacco_data)
source("C:/Users/nguye/Desktop/Prediction and Time Series Analysis/Week 1/Computer exercises 1-20211101/computer_exercise_week1.R", echo=TRUE)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
tobacco_data<- read.table('tobacco.txt', header=T, sep = '\t')
knitr::opts_chunk$set(echo = TRUE)
lm_ill <- lm(ILL ~ CONSUMPTION, data = tobacco_data)
summary(lm_ill)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
tobacco_data<- read.table('tobacco.txt', header=T, sep = '\t')
lm_ill <- lm(ILL ~ CONSUMPTION, data = tobacco_data)
summary(lm_ill)
?solve
knitr::opts_chunk$set(echo = TRUE)
consumption <- as.matrix(tobacco$CONSUMPTION)
consumption <- as.matrix(tobacco_data$CONSUMPTION)
n = nrow(tobacco)
consumption <- as.matrix(tobacco_data$CONSUMPTION)
n = nrow(tobacco)
consumption <- as.matrix(tobacco_data$CONSUMPTION)
n = nrow(tobacco_data)
Intercept <- rep(1,n)
X = cbind(Intercept, consumption)
View(consumption)
View(consumption)
View(X)
consumption <- as.matrix(tobacco_data$CONSUMPTION)
n = nrow(tobacco_data)
Intercept <- rep(1,n)
X = cbind(Intercept, consumption)
b_coefficient <- solve(t(X) %*% X) %*% t(X)%*% tobacco_data$ILL
View(b_coefficient)
View(b_coefficient)
?as.matrix
View(consumption)
consumption <- tobacco_data$CONSUMPTION
n = nrow(tobacco_data)
Intercept <- rep(1,n)
X = cbind(Intercept, consumption)
b_coefficient <- solve(t(X) %*% X) %*% t(X)%*% tobacco_data$ILL
View(X)
View(b_coefficient)
X <- tobacco_data$CONSUMPTION
b_coefficient <- solve(t(X) %*% X) %*% t(X)%*% tobacco_data$ILL
View(b_coefficient)
?rep
consumption <- tobacco_data$CONSUMPTION
n = nrow(tobacco_data)
Intercept <- rep(1,n)
X = as.matrix(cbind(Intercept, consumption))
b_coefficient <- solve(t(X) %*% X) %*% t(X)%*% tobacco_data$ILL
View(X)
consumption <- tobacco_data$CONSUMPTION
X = as.matrix(cbind(rep(1,nrow(tobacco_data)), consumption))
b_coefficient <- solve(t(X) %*% X) %*% t(X)%*% tobacco_data$ILL
consumption <- tobacco_data$CONSUMPTION
X = as.matrix(cbind(rep(1,nrow(tobacco_data)), consumption))
b_coefficient <- solve(t(X) %*% X) %*% t(X)%*% tobacco_data$ILL
View(b_coefficient)
consumption <- tobacco_data$CONSUMPTION
X = as.matrix(cbind(rep(1,nrow(tobacco_data)), consumption))
b_coefficient <- solve(t(X) %*% X) %*% t(X)%*% tobacco_data$ILL
b_coefficient[2]
consumption <- tobacco_data$CONSUMPTION
X = as.matrix(cbind(rep(1,nrow(tobacco_data)), consumption))
b_coefficient <- solve(t(X) %*% X) %*% t(X)%*% tobacco_data$ILL
b_coefficient
summary(lm_ill)
summary(lm_ill)$r.squared
p_value <- summary(lm_ill)$coefficients[,4][2]
alpha = 0.01
p_value < alpha
summary <- summary(lm_ill)
p_value <- summary(lm_ill)$coefficients[,4][2]
alpha = 0.01
p_value < alpha
View(summary)
summary[["coefficients"]]
p_value_consumption <- summary(lm_ill)$coefficients[,4][2] # p-value of CONSUMPTION
p_value_consumption < 0.01 # Level of significance
tobacco_data<- read.table('tobacco.txt', header=T, sep = '\t')
lm_ill <- lm(ILL ~ CONSUMPTION, data = tobacco_data)
summary <- summary(lm_ill)
summary
summary$r.squared
p_value_consumption <- summary$coefficients[4][2] # p-value of CONSUMPTION
p_value_consumption < 0.01 # Level of significance
p_value_consumption <- summary$coefficients[,4][2] # p-value of CONSUMPTION
p_value_consumption < 0.01 # Level of significance
t_value_consumption <- summary$coefficients[,3][2] # p-value of CONSUMPTION
t_value_consumption < 0.01 # Level of significance
t_value_consumption <- summary$coefficients[,3][2] # p-value of CONSUMPTION
t_value_consumption < 0.01 # Level of significance
t_value_consumption <- summary$coefficients[,3][2] # p-value of CONSUMPTION
t_value_consumption > 0.01 # Level of significance
t_value_consumption <- summary$coefficients[,3][2] # p-value of CONSUMPTION
t_value_consumption > 0.01 # Level of significance
t_value_consumption < p_value_consumption
View(tobacco_data)
plot(tobacco_data$CONSUMPTION, tobacco_data$ILL, xlab = "CONSUMPTION", ylab = "ILL")
abline(lm_ill)
?confint
confint(lm_ill, level = 95%)
confint(lm_ill, level = 0.95)
confint(lm_ill, level = 0.99)
confint(b_coefficient, level = 0.95)
confint(lm_ill, level = 0.95)
confint(lm_ill, level = 0.99)
?replicate
?sample
1:3
1:nrow(X)
sample(1:nrow(X), replace = TRUE)
X[inds,]
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
View(X)
X[inds,]
View(X)
inds
?replicate
source("C:/Users/nguye/Desktop/Prediction and Time Series Analysis/Week 1/Computer exercises 1-20211101/demo_week1.R", echo=TRUE)
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, beta[c(2,3,1)])
alpha = 0.5
apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))
?beta
beta[c(2,3,1)]
View(boot_samples)
View(X)
View(X)
View(X)
knitr::opts_chunk$set(echo = TRUE)
tobacco_data<- read.table('tobacco.txt', header=T, sep = '\t')
lm_ill <- lm(ILL ~ CONSUMPTION, data = tobacco_data)
summary <- summary(lm_ill)
summary
consumption <- tobacco_data$CONSUMPTION
X = as.matrix(cbind(rep(1,nrow(tobacco_data)), consumption))
b_coefficient <- solve(t(X) %*% X) %*% t(X)%*% tobacco_data$ILL
b_coefficient
consumption <- tobacco_data$CONSUMPTION
X = as.matrix(cbind(rep(1,nrow(tobacco_data)), consumption))
b_coefficient <- solve(t(X) %*% X) %*% t(X)%*% tobacco_data$ILL
b_coefficient
summary$r.squared
p_value_consumption <- summary$coefficients[,4][2] # p-value of CONSUMPTION
p_value_consumption < 0.01 # Level of significance
t_value_consumption <- summary$coefficients[,3][2] # p-value of CONSUMPTION
t_value_consumption > 0.01 # Level of significance
t_value_consumption < p_value_consumption
plot(tobacco_data$CONSUMPTION, tobacco_data$ILL, xlab = "CONSUMPTION", ylab = "ILL")
abline(lm_ill)
confint(lm_ill, level = 0.95)
confint(lm_ill, level = 0.99)
View(X)
y
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2)])
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.5
apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
bootstrap_confint <- apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))
bootstrap_confint
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
bootstrap_confint <- apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))[-3,]
bootstrap_confint
View(bootstrap_confint)
confint(lm_ill, level = 0.95)
confint(lm_ill, level = 0.99)
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
bootstrap_confint <- apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))[-3,]
bootstrap_confint
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
bootstrap_confint <- t(apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))[-3,])
bootstrap_confint
confint(lm_ill, level = 0.95)
confint(lm_ill, level = 0.99)
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
bootstrap_confint <- t(apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))[-3,])
bootstrap_confint
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
bootstrap_confint <- t(apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))[-3,])
bootstrap_confint
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
bootstrap_confint <- t(apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))[-3,])
bootstrap_confint
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
bootstrap_confint <- t(apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))[-3,])
bootstrap_confint
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
bootstrap_confint <- t(apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))[-3,])
bootstrap_confint
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
bootstrap_confint <- t(apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))[-3,])
bootstrap_confint
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
bootstrap_confint <- t(apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))[-3,])
bootstrap_confint
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
bootstrap_confint <- t(apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))[-3,])
bootstrap_confint
knitr::opts_chunk$set(echo = TRUE)
p_value_consumption <- summary$coefficients[,4][2] # p-value of CONSUMPTION
p_value_consumption < 0.01 # Level of significance
p_value_consumption <- summary$coefficients[,4][2] # p-value of CONSUMPTION
p_value_consumption < 0.01 # Level of significance
p_value
View(summary)
summary[["coefficients"]]
p_value_consumption <- summary$fstatistic # p-value of F-test
p_value_consumption < 0.01 # Level of significance
p_value
p_value_consumption <- summary$fstatistic # p-value of F-test
p_value_consumption < 0.01 # Level of significance
p_value
p_value_ftest <- summary$fstatistic # p-value of F-test
p_value
p_value_ftest < 0.01 # Level of significance
p_value_ftest <- summary$fstatistic # p-value of F-test
p_value
p_value_ftest  # Level of significance
View(summary)
summary
summary[["cov.unscaled"]]
summary[["coefficients"]]
summary
summary
p_value_consumption <- summary$coefficients[,4][2] # p-value of CONSUMPTION
p_value_consumption
p_value_consumption < 0.01 # Level of significance
knitr::opts_chunk$set(echo = TRUE)
tobacco_data<- read.table('tobacco.txt', header=T, sep = '\t')
lm_ill <- lm(ILL ~ CONSUMPTION, data = tobacco_data)
summary <- summary(lm_ill)
summary
consumption <- tobacco_data$CONSUMPTION
X = as.matrix(cbind(rep(1,nrow(tobacco_data)), consumption))
b_coefficient <- solve(t(X) %*% X) %*% t(X)%*% tobacco_data$ILL
b_coefficient
summary$r.squared
summary
p_value_consumption <- summary$coefficients[,4][2] # p-value of CONSUMPTION
p_value_consumption
p_value_consumption < 0.01 # Level of significance
plot(tobacco_data$CONSUMPTION, tobacco_data$ILL, xlab = "CONSUMPTION", ylab = "ILL")
abline(lm_ill)
confint(lm_ill, level = 0.95)
confint(lm_ill, level = 0.99)
n_boot <- 2000
fit_helper_i <- function(X,y) {
# Sample with replacement
inds <- sample(1:nrow(X), replace = TRUE)
X <- X[inds,]
y <- y[inds]
# Bootstrap LS estimate
solve((t(X) %*% X)) %*% t(X) %*% y
}
y <- tobacco_data$ILL
boot_samples <- replicate(n_boot, fit_helper_i(X,y), simplify = 'matrix')
boot_samples <- cbind(boot_samples, b_coefficient[2])
alpha = 0.05
bootstrap_confint <- t(apply(boot_samples, 1, function(x) quantile(x, probs = c(alpha/2, 1- alpha/2, 1-alpha/2)))[-3,])
bootstrap_confint
